{% extends "base.html" %} {% block title %} Eventos {% endblock %} 
{% block css%}
<style>
  .btn-soccer {
    color: #fff;
    background-color: #567804;
    border-color: #567804;
  }
  .btn-soccer:hover {
    color: #fff;
    background-color: #79a809;
    border-color: #79a809;
  }
  .border-soccer {
    border-color: #567804 !important;
  }
</style>
{% endblock %} {% block content %}
<div class="container">
  <div class="row mt-3 mb-5">
    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h2 class="panel-title">Administração</h2>
          <h6 class="fw-normal">Estatísticas e importação de jogos</h6>
        </div>
      </div>
    </div>
  </div>
  <div class="row justify-content-center">
    <div class="col-sm-7">
      <div class="card border-soccer text-center">
        <!-- <div class="card-header bg-soccer">
            Featured
          </div> -->
        <div class="card-body">
          <div class="row mb-4">
            <div class="col-sm-12">
              <h4 class="card-title">Estatísticas de Jogo</h4>
              <hr />
              <span class="card-text">Total de Ingressos: <b>{{ total_count }}</b></span><br />
              <span class="card-text">Total de Ingressos Dentro: <b>{{ valid_count }}</b></span><br />
              <span class="card-text">Total de Ingressos Bloqueados: <b>{{ already_checked_count }}</b></span
              ><br />
              <span class="card-text">Total de Ingressos Inválidos: <b>{{ invalid_count }}</b></span
              ><br />
            </div>
          </div>
          <div class="border-top border-1">
            <div class="row justify-content-center mt-4">
              <div class="col-sm-5 border-right border-1">
                <h5 class="card-title">Últimos ingressos válidos</h5>
                {% for valid_ticket in valid_tickets %}
                  <span class="card-text">{{valid_ticket.created_at|date:"h:i"}} - {{ valid_ticket.code }}</span><br />
                {% endfor %}
                {% if valid_tickets|length == 0 %}
                  <span class="card-text">Nenhum ingresso válido</span><br />
                {% endif %}
                <span class="card-text">-</span><br />
                <span class="card-text">-</span><br />
                <span class="card-text">-</span><br />
                <span class="card-text">-</span><br />
                <span class="card-text">-</span><br />
                <span class="card-text">-</span><br />
                <span class="card-text">-</span><br />
                <span class="card-text">-</span>
                {% comment %} {% if valid_tickets|length < 10 %}
                  {% for i in 1..(10-valid_tickets|length) %}
                    <span class="card-text">...</span><br />
                  {% endfor %}
                {% endif %} {% endcomment %}
              </div>
              <div class="col-sm-5">
                <h5 class="card-title">
                  Últimos ingressos inválidos
                </h5>
                {% for invalid_ticket in invalid_tickets %}
                  <span class="card-text"><span style="width: 30px">{{invalid_ticket.created_at|date:"h:i"}}</span> - {{ invalid_ticket.code }}</span><br />
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-5">
      <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
        <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
          <path
            d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"
          />
        </symbol>
      </svg>
      {% if msg %}
      <div class="alert alert-success alert-dismissible fade show" role="alert">
        <svg
          class="bi flex-shrink-0 me-2"
          width="24"
          height="24"
          role="img"
          aria-label="Success:"
        >
          <use xlink:href="#check-circle-fill" />
        </svg>
        {{ msg }}
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
          aria-label="Close"
        ></button>
      </div>
      {% endif %}
      <div class="card p-3">
        <div class="card-body">
          <div class="card-title mb-5">
            <h3>Importar Jogo</h3>
          </div>
          <form
            id="upload-file"
            action="/home"
            method="post"
            enctype="multipart/form-data"
          >
            {% csrf_token %}
            <div class="row">
              <div class="col-sm-8">
                <input
                  type="file"
                  class="form-control-file"
                  name="file"
                  id="file"
                  accept=".xslx, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
                />
              </div>
              <div class="col-sm-4">
                <button class="btn btn-soccer w-100" type="submit">
                  Enviar
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
      <div class="my-3">
        <div class="card p-3">
          <div class="card-body">
            <div class="row mb-3">
              <div class="col-sm-12">
                <label class="fw-bold">Selecionar Jogo</label>
                <select
                  class="form-select form-select"
                  aria-label=".form-select-lg example"
                >
                  <option selected>Selecione*</option>
                  {% for event in events %}
                    {% if event.is_running == 1 %}
                      <option value="{{ event.id }}" selected>{{ event.id }}</option>
                    {% else %}
                      <option value="{{ event.id }}">{{ event.id }}</option>
                    {% endif %}
                  {% endfor %}
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-sm-12">
                <label class="fw-bold">Selecionar Portão</label>
                <select
                  class="form-select form-select"
                  aria-label=".form-select-lg example"
                >
                  <option selected>Selecione*</option>
                  {% for gate in gates%}
                    <option value="{{ gate }}">{{ gate }}</option>
                  {% endfor %}
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-sm-6">
                <label class="fw-bold">Buscar por usuário</label>
                <input type="text" class="form-control">
              </div>
              <div class="col-sm-6">
                <label class="fw-bold">Buscar por ingresso</label>
                <input type="text" class="form-control">
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12">
                <button class="btn btn-soccer w-100">Filtrar</button>
              </div>
            </div>  
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
  <script>
    $.ajax({
      url: "refresh_tickets",
      type: 'GET',
      dataType: 'json',
      success: function(data) {
        console.log(data);
      }
    });
  </script>
{% endblock %}
